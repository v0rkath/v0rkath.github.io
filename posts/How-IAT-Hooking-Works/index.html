<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="How IAT Hooking Works" /><meta property="og:locale" content="en" /><meta name="description" content="Overview This method of hooking is done by changing the address of the function you want to hook in the IAT so it jumps to your code rather than the function. What is IDT, IAT &amp; ILT? The IDT is an acronym for ‘Import Directory Table’, this contains an array of IMAGE_IMPORT_DESCRIPTOR structs. This is usually found at the beginning of the .idata section of a binary (sometimes you may find it in .rdata). These structs are used for each imported DLL to the process. The IMAGE_IMPORT_DESCRIPTOR structs are laid out like so: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 typedef struct _IMAGE_IMPORT_DESCRIPTOR { union { DWORD Characteristics; // 0 for terminating null import descriptor DWORD OriginalFirstThunk; // RVA to the ILT/INT } DUMMYUNIONNAME; DWORD TimeDateStamp; /* 0 if not bound, -1 if bound, and real date\time stamp in IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT (new BIND) O.W. date/time stamp of DLL bound to (Old BIND) */ DWORD ForwarderChain; // -1 if no forwarders DWORD Name; DWORD FirstThunk; // RVA to IAT (if bound this IAT has actual addresses). } IMAGE_IMPORT_DESCRIPTOR; typedef IMAGE_IMPORT_DESCRIPTOR UNALIGNED *PIMAGE_IMPORT_DESCRIPTOR; The main things in the above struct that are mainly used for IAT Hooking at the OriginalFirstThunk (The relative virtual address to the ILT/INT), Name (name of the DLL) and FirstThunk (the relative virtual address to the IAT). Fig 1. General relationship of the Import Directory, IAT and ILT The ILT/INT is an acronym for either Import Lookup Table or Import Name Table, respectively. Both of which are names which are used interchangeably. The is a table of function names which have been imported into the process by the DLL. As just mentioned above the IMAGE_IMPORT_DESCRIPTOR contains the address of the ILT/INT. IAT stands for Import Address Table, so it pretty much does what it says on the tin; it’s a table of addresses for each imported function. However, on disk the IAT is identical to the ILT (so it just holds the names of the functions), but at runtime the loader overwrites the IAT with the addresses of those functions. Fig 2. IAT &amp; ILT on disk and at runtime I believe this is all you really need to know to understand how this hooking technique works. How does IAT Hooking work? This is relatively simple and has been used in various bits of malware for various purposes, some of which are: Stop a function from running Extract information from the function Simply just running additional code whenever the original function is called Fig 3. Example of how the IAT looks after it has hooked CreateFileW. It now has the address of our code rather than the address of CreateFileW which you can see in Fig 2 Once you have found the IAT and the function to hook, the process is the following: Change the address of the function in the IAT to the address of your own code, by doing this whenever that function is called it will go to your own code rather than the actual function. This will then run your own code and then you can jump to the original function to run it. Issues with IAT Hooking It is quite easy to detect this type of hooking as each imported function comes from another binary (example: kernel32.dll) and these have bounds in memory, so if the function address is changed in IAT to an address outside of the bounds then you know it’s not the original function and something funky is going on. If the import is imported via ordinal then you won’t be able to do this type of hooking." /><meta property="og:description" content="Overview This method of hooking is done by changing the address of the function you want to hook in the IAT so it jumps to your code rather than the function. What is IDT, IAT &amp; ILT? The IDT is an acronym for ‘Import Directory Table’, this contains an array of IMAGE_IMPORT_DESCRIPTOR structs. This is usually found at the beginning of the .idata section of a binary (sometimes you may find it in .rdata). These structs are used for each imported DLL to the process. The IMAGE_IMPORT_DESCRIPTOR structs are laid out like so: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 typedef struct _IMAGE_IMPORT_DESCRIPTOR { union { DWORD Characteristics; // 0 for terminating null import descriptor DWORD OriginalFirstThunk; // RVA to the ILT/INT } DUMMYUNIONNAME; DWORD TimeDateStamp; /* 0 if not bound, -1 if bound, and real date\time stamp in IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT (new BIND) O.W. date/time stamp of DLL bound to (Old BIND) */ DWORD ForwarderChain; // -1 if no forwarders DWORD Name; DWORD FirstThunk; // RVA to IAT (if bound this IAT has actual addresses). } IMAGE_IMPORT_DESCRIPTOR; typedef IMAGE_IMPORT_DESCRIPTOR UNALIGNED *PIMAGE_IMPORT_DESCRIPTOR; The main things in the above struct that are mainly used for IAT Hooking at the OriginalFirstThunk (The relative virtual address to the ILT/INT), Name (name of the DLL) and FirstThunk (the relative virtual address to the IAT). Fig 1. General relationship of the Import Directory, IAT and ILT The ILT/INT is an acronym for either Import Lookup Table or Import Name Table, respectively. Both of which are names which are used interchangeably. The is a table of function names which have been imported into the process by the DLL. As just mentioned above the IMAGE_IMPORT_DESCRIPTOR contains the address of the ILT/INT. IAT stands for Import Address Table, so it pretty much does what it says on the tin; it’s a table of addresses for each imported function. However, on disk the IAT is identical to the ILT (so it just holds the names of the functions), but at runtime the loader overwrites the IAT with the addresses of those functions. Fig 2. IAT &amp; ILT on disk and at runtime I believe this is all you really need to know to understand how this hooking technique works. How does IAT Hooking work? This is relatively simple and has been used in various bits of malware for various purposes, some of which are: Stop a function from running Extract information from the function Simply just running additional code whenever the original function is called Fig 3. Example of how the IAT looks after it has hooked CreateFileW. It now has the address of our code rather than the address of CreateFileW which you can see in Fig 2 Once you have found the IAT and the function to hook, the process is the following: Change the address of the function in the IAT to the address of your own code, by doing this whenever that function is called it will go to your own code rather than the actual function. This will then run your own code and then you can jump to the original function to run it. Issues with IAT Hooking It is quite easy to detect this type of hooking as each imported function comes from another binary (example: kernel32.dll) and these have bounds in memory, so if the function address is changed in IAT to an address outside of the bounds then you know it’s not the original function and something funky is going on. If the import is imported via ordinal then you won’t be able to do this type of hooking." /><link rel="canonical" href="https://v0rkath.github.io/posts/How-IAT-Hooking-Works/" /><meta property="og:url" content="https://v0rkath.github.io/posts/How-IAT-Hooking-Works/" /><meta property="og:site_name" content="v0rkath" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-12-20T14:15:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="How IAT Hooking Works" /><meta name="twitter:site" content="@v0rkath" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-12-20T18:18:18+00:00","datePublished":"2022-12-20T14:15:00+00:00","description":"Overview This method of hooking is done by changing the address of the function you want to hook in the IAT so it jumps to your code rather than the function. What is IDT, IAT &amp; ILT? The IDT is an acronym for ‘Import Directory Table’, this contains an array of IMAGE_IMPORT_DESCRIPTOR structs. This is usually found at the beginning of the .idata section of a binary (sometimes you may find it in .rdata). These structs are used for each imported DLL to the process. The IMAGE_IMPORT_DESCRIPTOR structs are laid out like so: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 typedef struct _IMAGE_IMPORT_DESCRIPTOR { union { DWORD Characteristics; // 0 for terminating null import descriptor DWORD OriginalFirstThunk; // RVA to the ILT/INT } DUMMYUNIONNAME; DWORD TimeDateStamp; /* 0 if not bound, -1 if bound, and real date\\time stamp in IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT (new BIND) O.W. date/time stamp of DLL bound to (Old BIND) */ DWORD ForwarderChain; // -1 if no forwarders DWORD Name; DWORD FirstThunk; // RVA to IAT (if bound this IAT has actual addresses). } IMAGE_IMPORT_DESCRIPTOR; typedef IMAGE_IMPORT_DESCRIPTOR UNALIGNED *PIMAGE_IMPORT_DESCRIPTOR; The main things in the above struct that are mainly used for IAT Hooking at the OriginalFirstThunk (The relative virtual address to the ILT/INT), Name (name of the DLL) and FirstThunk (the relative virtual address to the IAT). Fig 1. General relationship of the Import Directory, IAT and ILT The ILT/INT is an acronym for either Import Lookup Table or Import Name Table, respectively. Both of which are names which are used interchangeably. The is a table of function names which have been imported into the process by the DLL. As just mentioned above the IMAGE_IMPORT_DESCRIPTOR contains the address of the ILT/INT. IAT stands for Import Address Table, so it pretty much does what it says on the tin; it’s a table of addresses for each imported function. However, on disk the IAT is identical to the ILT (so it just holds the names of the functions), but at runtime the loader overwrites the IAT with the addresses of those functions. Fig 2. IAT &amp; ILT on disk and at runtime I believe this is all you really need to know to understand how this hooking technique works. How does IAT Hooking work? This is relatively simple and has been used in various bits of malware for various purposes, some of which are: Stop a function from running Extract information from the function Simply just running additional code whenever the original function is called Fig 3. Example of how the IAT looks after it has hooked CreateFileW. It now has the address of our code rather than the address of CreateFileW which you can see in Fig 2 Once you have found the IAT and the function to hook, the process is the following: Change the address of the function in the IAT to the address of your own code, by doing this whenever that function is called it will go to your own code rather than the actual function. This will then run your own code and then you can jump to the original function to run it. Issues with IAT Hooking It is quite easy to detect this type of hooking as each imported function comes from another binary (example: kernel32.dll) and these have bounds in memory, so if the function address is changed in IAT to an address outside of the bounds then you know it’s not the original function and something funky is going on. If the import is imported via ordinal then you won’t be able to do this type of hooking.","headline":"How IAT Hooking Works","mainEntityOfPage":{"@type":"WebPage","@id":"https://v0rkath.github.io/posts/How-IAT-Hooking-Works/"},"url":"https://v0rkath.github.io/posts/How-IAT-Hooking-Works/"}</script><title>How IAT Hooking Works | v0rkath</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="v0rkath"><meta name="application-name" content="v0rkath"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">v0rkath</a></div><div class="site-subtitle font-italic">Reverse Engineering & Malware Analysis</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/v0rkath" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/v0rkath" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>How IAT Hooking Works</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>How IAT Hooking Works</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1671545700" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Dec 20, 2022 </em> </span> <span> Updated <em class="" data-ts="1671560298" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Dec 20, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/v0rkath">v0rkath</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="605 words"> <em>3 min</em> read</span></div></div></div><div class="post-content"><h2 id="overview"><span class="mr-2">Overview</span><a href="#overview" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This method of hooking is done by changing the address of the function you want to hook in the IAT so it jumps to your code rather than the function.</p><hr /><h2 id="what-is-idt-iat--ilt"><span class="mr-2">What is IDT, IAT &amp; ILT?</span><a href="#what-is-idt-iat--ilt" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The IDT is an acronym for ‘Import Directory Table’, this contains an array of <code class="language-plaintext highlighter-rouge">IMAGE_IMPORT_DESCRIPTOR</code> structs. This is usually found at the beginning of the <code class="language-plaintext highlighter-rouge">.idata</code> section of a binary (sometimes you may find it in <code class="language-plaintext highlighter-rouge">.rdata</code>). These structs are used for each imported DLL to the process. The <code class="language-plaintext highlighter-rouge">IMAGE_IMPORT_DESCRIPTOR</code> structs are laid out like so:</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="k">typedef</span> <span class="k">struct</span> <span class="nc">_IMAGE_IMPORT_DESCRIPTOR</span> <span class="p">{</span>
    <span class="k">union</span> <span class="p">{</span>
        <span class="n">DWORD</span> <span class="n">Characteristics</span><span class="p">;</span> <span class="c1">// 0 for terminating null import descriptor</span>
        <span class="n">DWORD</span> <span class="n">OriginalFirstThunk</span><span class="p">;</span> <span class="c1">// RVA to the ILT/INT</span>
    <span class="p">}</span> <span class="n">DUMMYUNIONNAME</span><span class="p">;</span>
    
    <span class="n">DWORD</span> <span class="n">TimeDateStamp</span><span class="p">;</span> <span class="cm">/* 0 if not bound,
       -1 if bound, and real date\time stamp
       in IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT (new BIND)
       O.W. date/time stamp of DLL bound to (Old BIND) */</span>
    <span class="n">DWORD</span> <span class="n">ForwarderChain</span><span class="p">;</span> <span class="c1">// -1 if no forwarders</span>
    <span class="n">DWORD</span> <span class="n">Name</span><span class="p">;</span>
    <span class="n">DWORD</span> <span class="n">FirstThunk</span><span class="p">;</span> <span class="c1">// RVA to IAT (if bound this IAT has actual addresses).</span>
<span class="p">}</span> <span class="n">IMAGE_IMPORT_DESCRIPTOR</span><span class="p">;</span>
<span class="k">typedef</span> <span class="n">IMAGE_IMPORT_DESCRIPTOR</span> <span class="n">UNALIGNED</span> <span class="o">*</span><span class="n">PIMAGE_IMPORT_DESCRIPTOR</span><span class="p">;</span>
</pre></table></code></div></div><p>The main things in the above struct that are mainly used for IAT Hooking at the <code class="language-plaintext highlighter-rouge">OriginalFirstThunk</code> (The relative virtual address to the ILT/INT), <code class="language-plaintext highlighter-rouge">Name</code> (name of the DLL) and <code class="language-plaintext highlighter-rouge">FirstThunk</code> (the relative virtual address to the IAT).</p><p><img data-src="/assets/IDT-ILT-IAT-diagram.png" alt="Fig 1. Relationship of the Import Directory IAT, and ILT" data-proofer-ignore> <em>Fig 1. General relationship of the Import Directory, IAT and ILT</em></p><p>The ILT/INT is an acronym for either Import Lookup Table or Import Name Table, respectively. Both of which are names which are used interchangeably. The is a table of function names which have been imported into the process by the DLL. As just mentioned above the <code class="language-plaintext highlighter-rouge">IMAGE_IMPORT_DESCRIPTOR</code> contains the address of the ILT/INT.</p><p>IAT stands for Import Address Table, so it pretty much does what it says on the tin; it’s a table of addresses for each imported function. However, on disk the IAT is identical to the ILT (so it just holds the names of the functions), but at runtime the loader overwrites the IAT with the addresses of those functions.</p><p><img data-src="/assets/IAT-diagram.png" alt="Fig 2. IAT &amp; ILT on disk and on runtime" data-proofer-ignore> <em>Fig 2. IAT &amp; ILT on disk and at runtime</em></p><p>I believe this is all you really need to know to understand how this hooking technique works.</p><hr /><h2 id="how-does-iat-hooking-work"><span class="mr-2">How does IAT Hooking work?</span><a href="#how-does-iat-hooking-work" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This is relatively simple and has been used in various bits of malware for various purposes, some of which are:</p><ul><li>Stop a function from running<li>Extract information from the function<li>Simply just running additional code whenever the original function is called</ul><p><img data-src="/assets/Before-Hook-After-Hook.png" alt="Fig 3. Example of how the IAT looks after being hooked" data-proofer-ignore> <em>Fig 3. Example of how the IAT looks after it has hooked CreateFileW. It now has the address of our code rather than the address of CreateFileW which you can see in Fig 2</em></p><p>Once you have found the IAT and the function to hook, the process is the following:</p><ol><li>Change the address of the function in the IAT to the address of your own code, by doing this whenever that function is called it will go to your own code rather than the actual function.<li>This will then run your own code and then you can jump to the original function to run it.</ol><hr /><h2 id="issues-with-iat-hooking"><span class="mr-2">Issues with IAT Hooking</span><a href="#issues-with-iat-hooking" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ol><li>It is quite easy to detect this type of hooking as each imported function comes from another binary (example: <code class="language-plaintext highlighter-rouge">kernel32.dll</code>) and these have bounds in memory, so if the function address is changed in IAT to an address outside of the bounds then you know it’s not the original function and something funky is going on.<li>If the import is imported via ordinal then you won’t be able to do this type of hooking.</ol></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/reverse-engineering/'>Reverse Engineering</a>, <a href='/categories/hooking/'>Hooking</a>, <a href='/categories/hacking/'>Hacking</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/hooking/" class="post-tag no-text-decoration" >hooking</a> <a href="/tags/hook/" class="post-tag no-text-decoration" >hook</a> <a href="/tags/hacking/" class="post-tag no-text-decoration" >hacking</a> <a href="/tags/iat/" class="post-tag no-text-decoration" >IAT</a> <a href="/tags/ilt/" class="post-tag no-text-decoration" >ILT</a> <a href="/tags/idt/" class="post-tag no-text-decoration" >IDT</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=How+IAT+Hooking+Works+-+v0rkath&url=https%3A%2F%2Fv0rkath.github.io%2Fposts%2FHow-IAT-Hooking-Works%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=How+IAT+Hooking+Works+-+v0rkath&u=https%3A%2F%2Fv0rkath.github.io%2Fposts%2FHow-IAT-Hooking-Works%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fv0rkath.github.io%2Fposts%2FHow-IAT-Hooking-Works%2F&text=How+IAT+Hooking+Works+-+v0rkath" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/How-IAT-Hooking-Works/">How IAT Hooking Works</a><li><a href="/posts/How-Hooking-Works/">Basics of Hooking Functions</a><li><a href="/posts/sdfsdf/">RC4 (Rivest Cipher 4) - How it operates & how to recognise it</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hacking/">hacking</a> <a class="post-tag" href="/tags/hook/">hook</a> <a class="post-tag" href="/tags/hooking/">hooking</a> <a class="post-tag" href="/tags/decryption/">decryption</a> <a class="post-tag" href="/tags/encryption/">encryption</a> <a class="post-tag" href="/tags/iat/">IAT</a> <a class="post-tag" href="/tags/idt/">IDT</a> <a class="post-tag" href="/tags/ilt/">ILT</a> <a class="post-tag" href="/tags/rc4/">rc4</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/How-Hooking-Works/"><div class="card-body"> <em class="small" data-ts="1670709600" data-df="ll" > Dec 10, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Basics of Hooking Functions</h3><div class="text-muted small"><p> Overview This blog post is to provide a very basic overview of what a hook is and the general process of how it works. Hooks are used to ensure your code is run when a certain function of a proces...</p></div></div></a></div><div class="card"> <a href="/posts/sdfsdf/"><div class="card-body"> <em class="small" data-ts="1659348000" data-df="ll" > Aug 1, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>RC4 (Rivest Cipher 4) - How it operates & how to recognise it</h3><div class="text-muted small"><p> RC4 (Rivest Cipher 4) This is a very commonly used Stream Cipher (this transforms a plaintext string byte-by-byte, they are linear meaning they are a symmetric type of encryption). Typically has ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/How-Hooking-Works/" class="btn btn-outline-primary" prompt="Older"><p>Basics of Hooking Functions</p></a><div class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></div></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/v0rkath">v0rkath</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hacking/">hacking</a> <a class="post-tag" href="/tags/hook/">hook</a> <a class="post-tag" href="/tags/hooking/">hooking</a> <a class="post-tag" href="/tags/decryption/">decryption</a> <a class="post-tag" href="/tags/encryption/">encryption</a> <a class="post-tag" href="/tags/iat/">IAT</a> <a class="post-tag" href="/tags/idt/">IDT</a> <a class="post-tag" href="/tags/ilt/">ILT</a> <a class="post-tag" href="/tags/rc4/">rc4</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
